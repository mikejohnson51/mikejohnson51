---
output: 
  pdf_document:
    includes: 
      in_header: style.tex
classoption: 11pt
sansfont: Garamond
subparagraph: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE,
	results = 'asis'
)

source("global.R")

form = "Curriculum Vitae"
```

\lfoot{\textcolor{gray}{J.M. Johnson}}  
\cfoot{\textcolor{gray}{`r form`}}
\rfoot{\textcolor{black}{\thepage}} 
\renewcommand{\footrulewidth}{0.4pt}
\futurelet\TMPfootrule\def\footrule{\color{gray}{\TMPfootrule}}

 \centerline{\LARGE {{\textbf{J. MICHAEL JOHNSON }}}}
 \vspace{3mm}
 \centerline{\textsl{`r form` $\cdot$ `r today`}}
 \vspace{2mm}
 \centerline{\textcolor{gray}{University of California, Santa Barbara, California $\cdot$ Department of Geography}}
 \vspace{2mm}
 

\centerline{\textcolor{header_blue}{\textcolor{gray}{\faGlobe} \hspace{0.2mm} \url{ https://mikejohnson51.github.io}} $\cdot$
             \textcolor{gray}{\faEnvelope} \hspace{0.2mm} jmj00@ucsb.edu $\cdot$
             \textcolor{header_blue}{\textcolor{gray}{\faGithub} \hspace{0.2mm} \url{ https://github.com/mikejohnson51}}
             }

             
\vspace{4mm}
  
\begin{center}  
\begin{mybox}{Keywords:}
\begin{center}
 Geoinformatics (GIS);
 Hydroinformatics;
 Water Resource Modeling;
 Computational Hydrology
\end{center}
\end{mybox}
\end{center}
\vspace{4mm}

\header{EDUCATION:}
\newline
\hspace*{0mm}
\begin{tabular}{p{4cm}P{13.5cm}}
\textbf{March 2021 \newline (Expected)} & \textbf{University of California, Santa Barbara, California (UCSB)} 
\vspace{2mm}
\newline  $>$ \textbf{Degree:} \hspace{.95cm}PhD Candidate in Geography (ABD)
\vspace{2mm}
\newline  $>$ \textbf{Emphasis:} \hspace{.45cm}Modeling, Measurement, and Computation
\vspace{2mm}
\newline  $>$ \textbf{Advisor:} \hspace{.8cm}Dr. Keith C. Clarke
\vspace{2mm}
\newline  $>$ \textbf{Committee:} \hspace{.15cm}Dr(s) Hugo Loaiciga, Kelly Caylor, David Blodgett (USGS)
\vspace{2mm}\\
\textbf{2015} & \textbf{California Polytechnic State University, San Luis Obispo, CA}
\vspace{2mm}
\newline $>$ \textbf{Degree:} \hspace{.95cm}B.S. Anthropology \& Geography
\vspace{2mm}
\newline $>$ \textbf{Honors:} \hspace{.95cm}Cum Laude
\vspace{2mm}
\newline $>$ \textbf{Minors:} \hspace{.95cm}Geographic Information Systems (GIS) for Agriculture
\newline \tab \tab \hspace{1.1cm}Statistics
\newline \tab \tab \hspace{1.1cm}Water Science (Watershed Management Emphasis)  
\newline \tab \tab \hspace{1.1cm}Environmental Studies
\newline \tab \tab \hspace{1.1cm}Economics
\vspace{2mm}\\
\textbf{Visiting Researcher} & \textbf{Institute for Environmental Studies. Vrije Universiteit, Amsterdam}
\vspace{2mm}
\newline $>$ June - July 2019
\newline $>$ January - March 2018
\vspace{2mm}
\newline \textbf{Research Applications Laboratory. NCAR, Boulder Colorado}
\vspace{2mm}
\newline $>$ August - September 2018
\vspace{2mm}
\newline \textbf{NOAA National Water Center. Tuscaloosa, Alabama }
\vspace{2mm}
\newline $>$ June - August 2017
\newline $>$ June - August 2016
\end{tabular}
\vspace{2mm}

\header{EMPLOYMENT:}
\newline
\hspace*{0mm}
\begin{tabular}{p{4cm}P{13.5cm}}
\textbf{Sep 2019 - Present} & \textbf{Data Scientist}: \href{https://ufokn.github.io/UFOKN/}{Urban Flooding Open Knowledge Network} 
\vspace{2mm}\\
\textbf{Sep 2020 - Present} & \textbf{Water Resourcees Engineer II*}: Lynker Technologies/ NOAA-Affiliate
\newline
Assigned to the NOAA Next Generation Water Modeling Engine and Framework Prototype development group
\end{tabular}
*security clearance (secret)

\newpage
\centerline{\LARGE {{\textbf{Research}}}}
\header{PUBLICATIONS:}
```{r}
publications = read_excel("mikes-data.xlsx", sheet = "publications") %>% 
  filter(status != "4")

create_subsection <- function(stat) {
  
  cat("\\vspace{-3mm}")
  
  data <- publications %>% 
    filter(status == stat) %>% 
    map_df(rev)
  
  df <- data.frame(citation = paste0(data$authors, '.',
                                   ' (', data$year, '). ',
                                   '{"',  (data$title), '"}', 
                                   ifelse(endsWith(data$title, "?"), ' ', '. '),
                                   ifelse(rep(stat, nrow(data)) == "Working Papers",
                                          paste0(" In preparation", ifelse(!is.na(data$preprint),paste0('\\textsuperscript{1}'),"")),
                                          paste0("\\textit{", data$journal, "}", ifelse(!is.na(data$preprint),paste0('\\textsuperscript{1}'),""))), '. ',
                                   ifelse(is.na(data$link), 
                                          '', 
                                          paste0("\\href{", data$link, "}{Available here.}"))
                                   ))
  
  rownames(df) <- nrow(df):1
  
  print(xtable(df, align = c("r","P{15.5cm}"), caption = paste0("\\hspace{-5mm}", stat)),
      include.rownames = TRUE,
      floating = FALSE)
  
  if(any(!is.na(data$preprint))){
    cat("\\vspace{-4mm}")
    cat('\\tab\\textsuperscript{1}\\textcolor{gray}{Preprint available upon request.}')
    cat("\\vspace{8mm}")
  }
  
}

c("Peer-Reviewed Journal Articles", "In Review Articles", "Technical Reports",  "Cartography") %>% 
  purrr::walk(create_subsection)

stat = "Peer-Reviewed Journal Articles"

```

\header{SCIENTIFIC SOFTWARE:}

```{r}
cat("\\vspace{2mm}")
software = read_excel("mikes-data.xlsx", sheet = "software")

create_software_sections <- function(type) {
  
  cat("\\vspace{-3mm}")
  
  data <- filter(software, role == type)
  
  type <- stringr::str_to_title(type)

  cat("\\vspace{-3mm}")

  col2 <- paste0('{',bold(data$short_desc), '}', ' NEWLINE ', 'URL', data$link)

  df = data.frame(title = bold(data$main), desc = col2)
  
  rownames(df) <- nrow(df):1

  print(xtable(df, align = c("l","p{3cm}", "p{12.0cm}"),
                caption = paste0("\\hspace{-5mm}", type)),
        include.colnames = F,
        include.rownames = T,
        floating = TRUE,
        tabular.environment = "longtable",
        sanitize.colnames.function = boldheader)
  
  cat("\\vspace{2mm}")
}
  
software <- software %>% 
  filter(!is.na(short_desc)) %>% 
  select(main, short_desc, homepage, code, role) %>% 
  mutate(link = ifelse(is.na(homepage), code, homepage))

c("Author, Creator", "Author On", "Contributor To") %>% purrr::walk(create_software_sections)

cat("\\vspace{-6mm}")

```

Roles as assigned in package description and defined \href{https://journal.r-project.org/archive/2012-1/RJournal_2012-1_Hornik~et~al.pdf}{here}
\newline

\header{FUNDED PROJECTS:}
```{r}
grants = read_excel("mikes-data.xlsx", sheet = "funded_research")
grants$amount = italic(ifelse(is.na(grants$amount), "Not Disclosed", paste0("\\", scales::dollar(grants$amount))))


g1 = grants %>% select(date, role, name, source, amount) %>% 
  mutate(date = paste0('\\textbf{', date, "} ", '\\newline ', role),#bold(date),
         source    = paste0(name, "\\newline (", italic(source), ")")) %>% 
  select(date, source, amount)

rownames(g1) = nrow(g1):1
# create_subsection <- function(grants) {
#   
#   cat("\\vspace{-3mm}")
#   
#   df <- data.frame(citation = paste0('\\textbf{', grants$role, '}: ',
#                                     "\\textit{" , grants$name, "}, ",
#                                     grants$source, " (",grants$date, ")", 
#                                     " ",  grants$amount)
#                                    )
#   rownames(df) <- nrow(df):1
#   
#   print(xtable(df, align = c("r","P{15.5cm}")),
#       include.rownames = TRUE)
# }
#create_subsection(grants)

print(xtable(g1, align = c("l", "p{4cm}","p{10cm}", "P{1.5cm}" )),
      tabular.environment = 'longtable',
      floating = FALSE,
      include.rownames = T)

cat("\\vspace{-3mm}")
```


\newpage
\centerline{\LARGE {{\textbf{Teaching}}}}
\header{INSTRUCTOR, DEPARTMENT OF GEOGRAPHY, UCSB:}
\newline
\hspace*{0mm}
\begin{tabular}{p{4cm}P{13.5cm}}
\textbf{Summer 2020} & \textbf{Introduction to Geoinformatics}
\vspace{2mm}
\newline  $>$ Independently developed a complete Geoinformatics course to address the growing need for data science and programming in GIS profession.
\vspace{2mm}
\newline  $>$ Designed for remote instruction during COVID-19
\vspace{2mm}
\newline  $>$ Taught the foundations of reproducible data science, spatial data models, and programming to a class of 48 students
\vspace{2mm}
\newline  $>$ Will become new prerequisite spatial data/programming course for the UCSB Geography Department and new Masters is GIS Curriculum
\vspace{2mm}
\newline  $>$ Content Available here: \textcolor{header_blue}{\textcolor{gray}{\faUniversity} \hspace{0.2mm} \url{https://mikejohnson51.github.io/spds/}}
\vspace{2mm}
\end{tabular}
\vspace{2mm}


\vspace{3mm}
\header{TEACHING ASSISTANT, DEPARTMENT OF GEOGRAPHY, UCSB:}
```{r}
teaching = read_excel("mikes-data.xlsx", sheet = "teaching") %>% 
  filter(type == "Teaching Assisstant")

teaching <- teaching %>%
  mutate(quarter = factor(quarter, levels = c("Fall", "Winter", "Spring", "Summer"), 
                          ordered = T),
         class_link = ifelse(is.na(link), class, 
                             paste0('<a href="',link, '">', class, '</a>'))) %>% 
  group_by(class, class_link, division) %>%
  mutate(points = as.numeric(year) + as.numeric(quarter)/10,
         professor = paste(unique(professor), collapse = ", ")) %>% 
  summarise(year = paste(year,collapse=', '), 
            points = max(points),
            professor = professor[1]) %>% 
  tidyr::unite(data, year, sep = " ") %>% 
  arrange(desc(points)) 

#teaching[1,1] = paste0(teaching[1,1], "\\textsuperscript{1}")
  
col2 <- paste0('{', bold(teaching$class), '}', ' NEWLINE ', 
               teaching$division, " - ", italic(teaching$professor))

df = data.frame(date = bold(teaching$data),
                class = col2)

rownames(df) <- nrow(df):1

print(xtable(df, align = c("l","P{5cm}", "p{12.0cm}")),
      tabular.environment = 'longtable',
      floating = FALSE,
      include.rownames = T)

cat("\\vspace{-6mm}")
#cat('\\tab\\textsuperscript{1}\\textcolor{gray}{Grader}')
cat("\\vspace{3mm}")
cat("\\vspace{-6mm}")

```

\vspace{8mm}
\header{UNDERGRADUATE RESEARCH MENTORSHIP, UCSB:}
> Have served an a mentor for 9 undergraduates in formal capacities including independent research projects, inclusion in research efforts, and instructional independent study.
\newline
\newline
> Serving as a faculty mentor for the Gene & Susan Lucas Undergraduate Research Fund which was created to help first-generation undergraduate students experience research
\vspace{2mm}

<!-- ```{r} -->
<!-- cat("\\vspace{-3mm}") -->
<!-- mentorship = read_excel("mikes-data.xlsx", sheet = "mentorship") -->

<!-- df = data.frame(date = bold(mentorship$date), student = mentorship$name) -->

<!-- rownames(df) <- nrow(df):1 -->

<!-- print(xtable(df,  -->
<!--              align = c("r","p{2.5cm}", "P{14.0cm}")), -->
<!--              inlcude.rownames = TRUE) -->

<!-- cat("\\vspace{-6mm}") -->
<!-- ``` -->

\newpage
\centerline{\LARGE {{\textbf{Other}}}}
\header{AWARDS, FELLOWSHIPS, EXPERIANCE:}
\vspace{-3mm}

```{r}
awards = read_excel("mikes-data.xlsx", sheet = "awards") %>% 
  filter(type == "Awards and Fellowships") %>% 
  select(year, name, details, sort_year) %>% 
  filter(name != 'Jack & Laura Dangermond Fellowship')


experience = read_excel("mikes-data.xlsx", sheet = "experience")

df = data.frame(year = experience$data,
                name = experience$title,
                details = experience$location,
                sort_year = experience$sort_year)

df3 = rbind(df, awards) %>% 
  group_by(name) %>% 
  mutate(year = bold(paste0(sort(year, decreasing = TRUE), collapse = ", "))) %>% 
  slice(1) %>% 
  ungroup() %>% 
  arrange(desc(sort_year)) %>% 
  select(-sort_year) %>% 
  data.frame()

rownames(df3) <- nrow(df3):1

print(xtable(df3, align = c("l","p{2.5cm}", "p{7.5cm}", "P{6cm}")),
      tabular.environment = 'longtable',
      floating = FALSE,
      include.rownames = T)
```

\header{SERVICE:}
\vspace{-3mm}
```{r}
service = data.frame(
                service = c("Chair's Graduate Advisory Committee:",
                         "Spatial Data Science Faculty Search Committee:",
                         "Reviewer for: European Journal of Environmental and Civil Engineering, Transactions in GIS",
                         "Department Outreach Committee:"
                         ),
                date = c("2019-2021 Academic Year(s)",
                         "2018",
                         "",
                         "2015-2017"))

create_subsection <- function(grants) {
  
  cat("\\vspace{-3mm}")
  
  df <- data.frame(citation = paste0(service$service, ' \\textit{',service$date, "}" ))
  rownames(df) <- nrow(df):1
  
  print(xtable(df, align = c("r","P{15.5cm}")),
      include.rownames = TRUE)
}

create_subsection(grants)

cat("\\vspace{-3mm}")
```

<!-- \newpage -->
<!-- \header{EXPERIENCE:} -->
<!-- ```{r} -->
<!-- experience = read_excel("mikes-data.xlsx", sheet = "experience") -->

<!-- df = data.frame(date = bold(experience$data), -->
<!--                 title = experience$title, -->
<!--                 location = experience$location) -->
<!-- names(df) = bold(c("Year", "Postition", "Location")) -->

<!-- cat("\\vspace{-3mm}") -->

<!-- print(xtable(df, align = c("l","p{3cm}", "p{7.0cm}", "P{6.0cm}")), -->
<!--       include.colnames = F, -->
<!--       booktabs = TRUE, -->
<!--       sanitize.text.function = bold.somerows, -->
<!--       latex.environments = "left") -->

<!-- cat("\\vspace{-3mm}") -->
<!-- ``` -->

\header{PRESENTATIONS:}
```{r}
presentations = read_excel("mikes-data.xlsx", sheet = "presentations")
presentations$blank = ""

col2 <- paste0('{',bold(presentations$location), '}', ' NEWLINE ', italic(presentations$title))

df = data.frame(date = bold(presentations$data),
                title = col2,
                blank = presentations$blank,
                type = presentations$type)

rownames(df) <- nrow(df):1

print(xtable(df, align = c("l","p{2.5cm}", "P{9.5cm}", "p{.5cm}", "P{2cm}")),
      include.rownames = TRUE#,
      #booktabs = TRUE
      )

```

\header{REFERENCES:}
\vspace{-3mm}
```{r}
print_ref = function(x, df){
  df[nrow(df) + 1,] = paste0('{', bold(x[1]), '}', 
         ' NEWLINE ', 
         '{', italic(x[2]), '}', 
         ' NEWLINE ',
         '{', italic(x[3]), '}', 
         "\\vspace{2mm}")
  return(df)
}


df = data.frame(
  name = 'Keith Clarke, PhD',
  affil = 'Department of Geography University of California, Santa Barbara, USA',
  email = 'kcclarke@ucsb.edu')

df = add_row(df, 
  name  = 'Krzysztof Janowicz, PhD',
  affil = 'Department of Geography University of California, Santa Barbara, USA',
  email ='janowicz@ucsb.edu')

df = add_row(df, 
  name = 'Lilit Yeghiazarian, PhD', 
  affil = 'Associate Professor, Environmental Engineering & Science',
  email = 'yeghialt@ucmail.uc.edu')


df = add_row(df, 
name = 'Trey Flowers, PhD', 
affil = 'Director of the Analysis and Prediction Division at the National Water Center', 
email = 'trey.flowers@noaa.gov') 

df = add_row(df, 
  name = 'David Blodgett', 
  affil = 'USGS Office of Water Information Center for Integrated Data Analytics',
email = 'dblodgett@usgs.gov')

df$name = paste0('{', bold(df$name), '} NEWLINE ')
df$affil = paste0('{', (df$affil), '} NEWLINE ')
df$email = italic(df$email)


rownames(df) <- nrow(df):1


print(xtable(data.frame(do.call(paste0, c(df[,1:3]))), align = c("l","p{20cm}"),
        include.colnames = F,
        include.rownames = T,
        floating = TRUE,
        tabular.environment = "tabular",
        sanitize.colnames.function = boldheader))
```